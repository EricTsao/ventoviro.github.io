<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../../../media/images/favicon.ico" />

    <title>Asset Manager | Windwalker - A Modern PHP Framework</title>

    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="../../../media/css/bootstrap.css" />
    <link rel="stylesheet" href="../../../media/css/bootstrap-material-design.css" />
    <link rel="stylesheet" href="../../../media/css/ripples.css" />
    <link rel="stylesheet" href="../../../media/css/main.css" />
    <link rel="stylesheet" href="../../../media/css/prism.css" />

    <meta name="description" content="">
    <meta name="generator" content="The Time Machine">

    <meta property="og:title" content="Asset Manager | Windwalker - A Modern PHP Framework">
    <meta property="og:site_name" content="Windwalker Framework">

        

    <style>
        #header {
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 500;
            border-bottom: 1px solid #eee;
        }

        body {
            padding-top: 70px;
        }
    </style>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../../media/js/jquery.js"></script>
    <script src="../../../media/js/bootstrap.js"></script>
    <script src="../../../media/js/material.js"></script>
    <script src="../../../media/js/prism.js"></script>
    <script>
        $(document).ready(function() {

            $('.article-content pre code').each(function(i, block) {
                var $this = $(this);

                $this.attr('class', 'language-' + $this.attr('class'));
            });
        });
    </script>

        <script src="../../../media/js/doc.js"></script>
</head>
<body class="">

<section id="header">

    <section id="nav">

        <div class="navbar navbar-transparent">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="javascript:void(0)">Brand</a>
                </div>
                <div class="navbar-collapse collapse navbar-responsive-collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="javascript:void(0)">Active</a></li>
                        <li><a href="javascript:void(0)">Link</a></li>
                        <li class="dropdown">
                            <a href="http://fezvrasta.github.io/bootstrap-material-design/bootstrap-elements.html" data-target="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown
                                <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="javascript:void(0)">Action</a></li>
                                <li><a href="javascript:void(0)">Another action</a></li>
                                <li><a href="javascript:void(0)">Something else here</a></li>
                                <li class="divider"></li>
                                <li class="dropdown-header">Dropdown header</li>
                                <li><a href="javascript:void(0)">Separated link</a></li>
                                <li><a href="javascript:void(0)">One more separated link</a></li>
                            </ul>
                        </li>
                    </ul>
                    <form class="navbar-form navbar-left">
                        <div class="form-group">
                            <input type="text" class="form-control col-sm-8" placeholder="Search">
                        </div>
                    </form>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="javascript:void(0)">Link</a></li>
                        <li class="dropdown">
                            <a href="http://fezvrasta.github.io/bootstrap-material-design/bootstrap-elements.html" data-target="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown
                                <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="javascript:void(0)">Action</a></li>
                                <li><a href="javascript:void(0)">Another action</a></li>
                                <li><a href="javascript:void(0)">Something else here</a></li>
                                <li class="divider"></li>
                                <li><a href="javascript:void(0)">Separated link</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </section>

    <section id="banner" class="container text-center">
        <div class="row">
            <div class="banner-content col-md-6">
                <h1 class="banner-title">WINDWALKER</h1>
                <h3 class="slab-font">Rapid Application Development Framework<br />for PHP</h3>
            </div>
        </div>
    </section>

</section>

<div id="main-body" class="main main-raised main-raised-bottom">
        <div class="uk-container uk-container-center">
        <div class="uk-grid">
                <div class="uk-width-medium-1-4 uk-container-center">
        <ul class="uk-nav uk-nav-side side-menu side-bar" data-uk-nav="">
    
                
        <li class="uk-nav-header">Start</li>
                    <li class="">
                <a href="../../../documentation/3.x/start/installation.html">Installation</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/start/getting-started.html">Getting Started</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">Core</li>
                    <li class="">
                <a href="../../../documentation/3.x/core/routing.html">Routing</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/package-system.html">Packages</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/config.html">Config &amp; Setting</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/request-input.html">Request and Input</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/psr7-middlewares.html">Psr7 and Middlewares</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/ioc-container.html">IoC Container</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/core/service-provider.html">Service Provider</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">MVC</li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/use-controller.html">Use Controller</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/class-resolvers.html">Class Resolvers</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/view-templating.html">View and Templating</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/edge.html">Edge Templates</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/model-database.html">Model and Database</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/view-model.html">ViewModel</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/mvc/uri-route-building.html">URI and Route Building</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">Database</li>
                    <li class="">
                <a href="../../../documentation/3.x/db/basic.html">Basic Usage</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/read-write.html">Read and Write</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/table-schema.html">Table and Schema</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/query-builder.html">Query Builder</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/active-record.html">ActiveRecord</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/datamapper.html">DataMapper</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/db/migration.html">Migration And Seeding</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">Services</li>
                    <li class="">
                <a href="../../../documentation/3.x/services/authentication.html">Authentication</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/authorisation.html">Authorisation</a>
            </li>
                    <li class="uk-active">
                <a href="../../../documentation/3.x/services/asset.html">Asset Manager</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/caching.html">Caching</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/datetime.html">DateTime</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/environment.html">Environment</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/events.html">Events</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/languages.html">Languages</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/session.html">Session</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/widget-renderer.html">Widget and Renderer</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/mailer.html">Mailer</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/debugging.html">Debugging and Logging</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/services/error-handling.html">Error Handling</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">Console</li>
                    <li class="">
                <a href="../../../documentation/3.x/console/console-basic.html">Basic Usage</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/console/custom-commands.html">Custom Commands</a>
            </li>
        
    <li class="uk-nav-divider"></li>
       <li class="uk-nav-header">More</li>
                    <li class="">
                <a href="../../../documentation/3.x/more/data-object.html">Data Object</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/http-stream.html">Http and Stream</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/structure.html">Structure Object</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/crypt.html">Crypt</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/form-builder.html">Form Builder</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/form-definition.html">Form Definition</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/filesystem.html">Filesystem</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/html-builder.html">HTML Builder</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/pagination.html">Pagination</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/string.html">String</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/tests.html">Tests</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/validation.html">Validation</a>
            </li>
                    <li class="">
                <a href="../../../documentation/3.x/more/more-packages.html">More Packages</a>
            </li>
        
    <li class="uk-nav-divider"></li>
   </ul>
    </div>

            <div class="uk-width-medium-3-4 uk-container-center">
                <article class="article-content">
                    <h2>Get Assets Path</h2>

<p>Windwalker stores asset files in <code>/www/asset</code>, we can get the path or full URL of this folder:</p>

<pre><code class="php">use Windwalker\Core\Asset\Asset;

echo Asset::path(); // /path/to/windwalker/asset
echo Asset::root(); // http://domain.com/path/to/windwlaker/asset
</code></pre>

<p>You can simply use <code>$asset-&gt;path</code> in view template:</p>

<pre><code class="php">&lt;script src="&lt;?php echo $asset-&gt;path; ?&gt;/js/bootstrap.js"&gt;&lt;/script&gt;
</code></pre>

<p>Or use method call:</p>

<pre><code class="php">&lt;script src="&lt;?php echo $asset-&gt;path('js/bootstrap.js'); ?&gt;"&gt;&lt;/script&gt;
</code></pre>

<h3>Set Full Asset Uri</h3>

<p>Add <code>asset.uri</code> to config if you store assets in cloud storage:</p>

<pre><code class="yaml">asset:
    uri: https://foo.s3.amazonaws.com/assets
</code></pre>

<p>Now <code>$asset-&gt;path</code> and <code>$asset-&gt;root</code> will be <code>https://foo.s3.amazonaws.com/assets</code>.</p>

<h2>Use Asset to Include CSS &amp; JS</h2>

<pre><code class="php">use Windwalker\Core\Asset\Asset;

Asset::addCSS('css/bootstrap.css');
Asset::addJS('js/bootstrap.js');

// In template
$asset-&gt;addCSS('css/bootstrap.css');
$asset-&gt;addJS('js/bootstrap.js');
</code></pre>

<p>Windwalker will auto includes these files in <code>&lt;head&gt;</code>:</p>

<pre><code class="php">&lt;link rel="stylesheet" href="/windwalker/www/asset/css/bootstrap.css?ee8f77834fabe4188265a599a77f2c21" /&gt;

&lt;script src="/windwalker/www/asset/js/bootstrap.js?ee8f77834fabe4188265a599a77f2c21"&gt;&lt;/script&gt;
</code></pre>

<p>If you are not use default template, you must confirm your template has rendered styles and scripts:</p>

<pre><code class="php">&lt;?php echo $asset-&gt;renderStyles(true); ?&gt;

&lt;?php echo $asset-&gt;renderScripts(true); ?&gt;
</code></pre>

<h3>Include Compressed Files</h3>

<p>You can add <code>.min</code> to file name, Windwalker will auto check compressed file exists or not, and will fallback to normal file if
there has no min file.</p>

<p>And in DEBUG mode, Windwalker will force include uncompressed file if exists, otherwise fallback to min file.</p>

<pre><code class="php">// If `bootstrap.css` exists but `bootstrap.min.css` not
Asset::addCSS('css/bootstrap.min.css'); // bootstrap.css
Asset::addCSS('css/bootstrap.css'); // bootstrap.css

// If `bootstrap.min.css` exists but `bootstrap.css` not
Asset::addCSS('css/bootstrap.min.css'); // bootstrap.min.css
Asset::addCSS('css/bootstrap.css'); // bootstrap.min.css

// If both exists in DEBUG mode
Asset::addCSS('css/bootstrap.min.css'); // bootstrap.css
Asset::addCSS('css/bootstrap.css'); // bootstrap.css

// If both exists and not in DEBUG mode
Asset::addCSS('css/bootstrap.min.css'); // bootstrap.min.css
Asset::addCSS('css/bootstrap.css'); // bootstrap.min.css
</code></pre>

<h2>Alias</h2>

<p>If you want to override an asset's URL, for instance, to modify a 3rd party scripts, you can use asset alias:</p>

<pre><code class="php">Asset::alias('js/my-grid.js', 'phoenix/js/grid.js');

Asset::addJS('phoenix/js/grid.min.js');
</code></pre>

<p>Now Windwlaker will include <code>js/my-grid.js</code> to HTML, don't worry about <code>.min</code>, AssetManager will normalize the path.</p>

<h2>Asset Versions</h2>

<p>Windwalker auto add version hash string to every asset URL. In DEBUG mode, this version string will always refresh
after page reload. And in normal mode, AssetManager will hash version by the modified time of every asset files to make sure
version not changed, but can be refresh if any file has been modified.</p>

<p>You can add your own version to specific asset file:</p>

<pre><code class="php">Asset::addCSS('css/bootstrap.css', md5('1.0.5'));
</code></pre>

<p>Or add an md5 sum in cache folder, so all assets will use this cached version that make better performance.</p>

<pre><code class="bash">$ php windwlaker asset makesum
Create SUM: d9edf273fc270b99e1c5a0f5d9a96b3d at {ROOT}/cache/asset/MD5SUM
</code></pre>

<blockquote>
  <p>You must run this command after every new version of you system deployed, otherwise the end users' browser may cache
  the old assets files and will break your front-end application.</p>
</blockquote>

<h2>Asset Template</h2>

<p>Sometimes your Widget need push a JS template to the bottom of <code>&lt;body&gt;</code>, we can wrap this template by <code>AssetTemplate</code>:</p>

<pre><code class="php">&lt;script&gt;
    alert(jQuery('#hello').html());
&lt;/script&gt;

&lt;?php $asset-&gt;getTemplate()-&gt;startTemplate('asset.name'); ?&gt;
&lt;script id="hello" type="text/template"&gt;
    &lt;h1&gt;Hello &lt;?php echo $content; ?&gt;&lt;/h1&gt;
&lt;/script&gt;
&lt;?php $asset-&gt;getTemplate()-&gt;endTemplate(); ?&gt;
</code></pre>

<p>Make sure your template has render asset template as bottom of body:</p>

<pre><code class="php">...

&lt;?php echo $asset-&gt;getTemplate()-&gt;renderTemplates(); ?&gt;
&lt;/body&gt;
</code></pre>

<p>Simple tag in Edge and Blade:</p>

<pre><code class="php">@assetTemplate('asset.name')
&lt;script id="hello" type="text/template"&gt;
    &lt;h1&gt;Hello {{ $content }}&lt;/h1&gt;
&lt;/script&gt;
@endTemplate()
</code></pre>

<h2>Asset Dependency</h2>

<p><code>Windwalker\Core\Asset\AbstractScript</code> is a dependency manager, we can create methods as dependency handler and call it anywhere.</p>

<p>This is an example to load a <code>sakura.js</code> and init it for different HTML selectors, and it is dependent on <code>flower.js</code>.</p>

<pre><code class="php">namespace Flower\Script;

use Windwalker\Core\Asset\AbstractScript;

class FlowerScript extends AbstractScript
{
    public static function jquery()
    {
        if (!static::inited(__METHOD__))
        {
            static::addJS('js/jquery/jquery.min.js');
        }
    }

    public static function flower()
    {
        if (!static::inited(__METHOD__))
        {
            // flower.js needs jquery.js first
            static::jquery();

            // If we need other scripts, call them first.
            OtherScript::core();

            static::addJS('js/flower.min.js');
            static::addCSS('js/flower.min.css');
        }
    }

    public static function sakura($selector = '.hasSakura', $options = array())
    {
        $args = get_defined_vars();

        // Include asset file first.
        if (!static::inited(__METHOD__))
        {
            // sakura.js needs flower.js first
            static::flower();

            // If not in debug mode, Windwalker will auto get min file instead.
            static::addJS('sakura.js');
        }

        // Call only once with same arguments
        if (!static::inited(__METHOD__, $args))
        {
            $defaultOptions = array(
                'foo' =&gt; 'bar',
                'callback' =&gt; '\\function () {}' // Start with \\ will not be quoted
            );

            // Recursive merge options to defaultOptions and print a JS option string.
            $options = $asset::getJSObject($defaultOptions, $options);

            $js = &lt;&lt;&lt;JS
jQuery(document).ready(function($) {
    $('$selector').sakuraInit($options);
});
JS;

            // Add inline JS in &lt;head&gt;
            static::internalJS($js);
        }
    }
}
</code></pre>

<p>Now use this code to include <code>sakura.js</code> every where:</p>

<pre><code class="php">\Flower\Script\FlowerScript::sakura('.mySakura', array('foo' =&gt; 'baz'));
</code></pre>

<h2>Sync Package Assets</h2>

<p>Put your package asset files to <code>{package}/Resources/asset</code>, then you can run this command to sync asset files to
web public root.</p>

<pre><code class="bash">$ php windwalker asset sync
</code></pre>

<p>Windwalker will make a symbol link to your package asset folder, if you are using Windows, you must do this with Administrator access.
You can also add <code>--hard</code> to hard copy all asset files to public folder.</p>

<p>Change public asset folder by modifying <code>etc/config.yml</code>:</p>

<pre><code class="yaml">asset:
    folder: asset
</code></pre>

                        <hr />

    <p class="uk-text-center">
        Help us <a target="_blank" href="https://github.com/ventoviro/ventoviro.github.io/tree/master/.vaseman/entries/documentation/3.x/services/asset.md">improve</a> this document.
    </p>
                </article>
            </div>
        </div>
    </div>
</div>

<section id="footer" class="black-block inner-md text-center">

    <div class="container inner-top-md">
        
        <p>
            <a href="https://github.com/ventoviro/windwalker" class="btn" target="_blank">
                <i class="fa fa-github"></i>
                GitHub
            </a>

            <a href="http://natika.windwalker.io" class="btn" target="_blank">
                <i class="fa fa-comments"></i>
                Forum
            </a>

            <a href="javascript:void(0);" class="btn" target="_blank">
                <i class="fa fa-code"></i>
                API
            </a>
        </p>

        <p class="outer-top-xs">
            <a class="text-center footer-logo">
                <img width="250" src="../../../media/images/logo/windwalker-logo.png" alt="Logo" style="">
            </a>
        </p>

        <p class="lead outer-top-xs">
            Copyright © 2016 Windwalker. All Rights Reserved.
        </p>
    </div>

</section>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-48372917-6', 'auto');
    ga('send', 'pageview');

</script>

</body>
</html>
